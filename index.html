<!DOCTYPE html>
<html lang="en" class="h-full dark:feyoudao-bg-gray-900 bg-white">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>前端有道</title>
  <meta name="keywords" content="feyoudao, Bookmarks, Link Management, Export Bookmarks, Website Bookmarks">
  <meta name="description"
    content="feyoudao is a powerful tool that helps you manage and export your browser bookmarks, converting them into an aesthetically pleasing website that is easy to share and access.">
  <meta name="author" content="feyoudao">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://www.feyoudao.cn">
  <script defer src="https://cloud.umami.is/script.js" data-website-id="60283522-e543-4dcb-bd47-e855f1e0a635"></script>
  <script defer data-domain="feyoudao.cn" src="https://plausible.io/js/script.js"></script>
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "ptorvwye5a");
  </script>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-P1JF3QTQ79"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-P1JF3QTQ79');
  </script>

  <!-- Facebook Meta Tags -->
  <meta property="og:url" content="https://www.feyoudao.cn">
  <meta property="og:type" content="website">
  <meta property="og:title" content="feyoudao">
  <meta property="og:description" content="Managing and Exporting your Bookmarks into a Website">
  <meta property="og:image" content="https://app.feyoudao.cn/assets/og.png">

  <!-- Twitter Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="twitter:domain" content="feyoudao.cn">
  <meta property="twitter:url" content="https://www.feyoudao.cn">
  <meta name="twitter:title" content="feyoudao">
  <meta name="twitter:description" content="Managing and Exporting your Bookmarks into a Website">
  <meta name="twitter:image" content="https://app.feyoudao.cn/assets/og.png">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
  <link rel="mask-icon" href="assets/favicon/favicon-32x32.png" color="#0b0b0f">

  <!-- Stylesheet -->
  <link rel="stylesheet" href="css/tailwind.css">

  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": "https://www.feyoudao.cn",
    "name": "feyoudao",
    "description": "Managing and Exporting your Bookmarks into a Website",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://www.feyoudao.cn/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <style>
    /* 卡片载入动画 */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card-animate {
      animation: fadeInUp 0.3s ease-out forwards;
      opacity: 0;
    }

    /* 增强卡片层次感 */
    .card-shadow {
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .card-shadow:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transform: translateY(-2px);
    }

    /* 文件夹卡片颜色标签 */
    .folder-tag {
      position: absolute;
      top: 0;
      right: 0;
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    /* 优化移动端触摸反馈 */
    @media (max-width: 768px) {
      .touch-feedback:active {
        background-color: rgba(0,0,0,0.05);
      }

      .dark .touch-feedback:active {
        background-color: rgba(255,255,255,0.1);
      }
    }
  </style>
</head>

<body class="h-full dark:feyoudao-bg-gray-900 bg-white">

  <div>
    <!-- Mobile Off-Canvas Menu -->
    <div id="off-canvas-menu" class="relative z-50 hidden" role="dialog" aria-modal="true">
      <div id="off-canvas-backdrop"
        class="fixed inset-0 bg-gray-900/80 opacity-0 transition-opacity ease-linear duration-300"></div>
      <div class="fixed inset-0 flex">
        <div id="off-canvas-content"
          class="relative mr-16 flex w-full max-w-xs flex-1 -translate-x-full transition ease-in-out duration-300 transform">
          <!-- Close button for the off-canvas menu -->
          <div class="absolute left-full top-0 flex w-16 justify-center pt-5">
            <button id="close-sidebar-button" type="button" class="-m-2.5 p-2.5">
              <span class="sr-only">关闭侧边栏</span>
              <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>

          <!-- Off-canvas Sidebar content -->
          <div class="flex grow flex-col gap-y-5 overflow-y-auto bg-white dark:feyoudao-bg-gray-900 px-6 pb-4">
            <div class="flex h-16 shrink-0 items-center">
              <img class="pl-2 h-8 w-auto" src="assets/logo.svg" alt="feyoudao">
              <a href="" class="ml-4 font-extrabold text-2xl dark:text-white">前端有道</a>
            </div>
            <div id="sidebar-2" class="flex flex-1 flex-col">
              <!-- Sidebar content will be injected here -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Static Sidebar for Desktop -->
    <div class="hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-60 lg:flex-col">
      <div
        class="flex flex-col border-r border-gray-200 dark:feyoudao-border-gray-800 bg-white px-4 h-full font-semibold dark:feyoudao-bg-gray-900">
        <div class="flex p-0 h-16 shrink-0 items-center">
          <img class="pl-2 h-8 w-auto" src="assets/logo.svg" alt="feyoudao">
          <a href="" class="ml-4 font-extrabold text-2xl dark:text-white">前端有道</a>
        </div>
        <div class="flex flex-1 flex-col overflow-y-auto no-scrollbar p-1 cursor-pointer">
          <div id="sidebar" class="flex flex-1 flex-col">
            <ul id="navigation" class="space-y-1">
              <!-- Navigation items will be inserted here -->
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="lg:pl-60 dark:feyoudao-bg-gray-900 flex flex-col min-h-screen">
      <div
        class="items-center justify-between sticky top-0 z-40 flex h-16 shrink-0 gap-x-4 border-b border-gray-200 dark:feyoudao-border-gray-800 bg-white dark:feyoudao-bg-gray-900 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8">
        <div class="h-full items-center flex flex-1 gap-x-4 self-stretch lg:gap-x-6 justify-between">
          <div class="flex gap-x-4 justify-between">
            <img class="pl-2 h-8 w-auto lg:hidden" src="assets/logo.svg" alt="feyoudao">
            <!-- hidden lg:block -->
            <div class="relative w-72 h-full items-center justify-between">
              <button id="searchButton" class="absolute h-full text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200 rounded pl-2">
                <svg class="pointer-events-none absolute inset-y-0 left-0 h-full w-5 text-gray-400" viewBox="0 0 20 20"
                  fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd"
                    d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"
                    clip-rule="evenodd"></path>
                </svg>
              </button>
              <input id="searchInput" type="search"
                class="text-sm text-gray-900 dark:text-gray-400 pl-8 h-full border-0 focus:outline-none focus:ring-0 dark:feyoudao-bg-gray-900 w-full"
                placeholder="搜索书签...">
              <button id="clearSearchButton" class="text-sm text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200 absolute right-2 rounded hidden">
                清除
              </button>
            </div>
          </div>
          <a href="" class="hidden ml-4 font-extrabold text-2xl dark:text-white">前端有道</a>
          <div class="relative">
            <button id="themeToggleButton" type="button" aria-label="切换主题"
              class="group rounded-full bg-white/90 p-2 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur transition-all duration-300 dark:feyoudao-bg-gray-900 dark:ring-white/10 dark:hover:ring-white/20 hover:shadow-md">
              <svg id="sunIcon" viewBox="0 0 24 24" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                aria-hidden="true"
                class="h-6 w-6 fill-zinc-100 stroke-zinc-500 transition group-hover:fill-zinc-200 group-hover:stroke-zinc-700 dark:hidden [@media(prefers-color-scheme:dark)]:fill-teal-50 [@media(prefers-color-scheme:dark)]:stroke-teal-500 [@media(prefers-color-scheme:dark)]:group-hover:fill-teal-50 [@media(prefers-color-scheme:dark)]:group-hover:stroke-teal-600">
                <path
                  d="M8 12.25A4.25 4.25 0 0 1 12.25 8v0a4.25 4.25 0 0 1 4.25 4.25v0a4.25 4.25 0 0 1-4.25 4.25v0A4.25 4.25 0 0 1 8 12.25v0Z">
                </path>
                <path
                  d="M12.25 3v1.5M21.5 12.25H20M18.791 18.791l-1.06-1.06M18.791 5.709l-1.06 1.06M12.25 20v1.5M4.5 12.25H3M6.77 6.77 5.709 5.709M6.77 17.73l-1.061 1.061"
                  fill="none"></path>
              </svg>
              <svg id="moonIcon" viewBox="0 0 24 24" aria-hidden="true"
                class="hidden h-6 w-6 fill-zinc-700 stroke-zinc-500 transition dark:block [@media(prefers-color-scheme:dark)]:group-hover:stroke-zinc-400 [@media_not_(prefers-color-scheme:dark)]:fill-teal-400/10 [@media_not_(prefers-color-scheme:dark)]:stroke-teal-500">
                <path
                  d="M17.25 16.22a6.937 6.937 0 0 1-9.47-9.47 7.451 7.451 0 1 0 9.47 9.47ZM12.75 7C17 7 17 2.75 17 2.75S17 7 21.25 7C17 7 17 11.25 17 11.25S17 7 12.75 7Z"
                  stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Main content area -->
      <main class="mt-4 dark:feyoudao-bg-gray-900 flex-grow">
        <div id="loading-spinner" class="flex justify-center items-center h-64 w-full">
          <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 border-t-teal-500 h-12 w-12 animate-spin"></div>
        </div>
        <div id="breadcrumbs" class="mt-2 px-6 text-sm text-gray-400 flex justify-between items-center">
          <div id="breadcrumbs-path" class="">
            <!-- Breadcrumbs will be inserted here -->
          </div>
        </div>
        <div id="bookmarks" class="grid gap-6 p-6">
          <!-- Bookmark cards will be inserted here -->
        </div>
      </main>

      <!-- Footer -->
      <footer class="bg-white w-full dark:feyoudao-bg-gray-900">
        <div class="mx-auto px-6 py-6 md:flex md:items-center md:justify-between lg:px-8">
          <!-- <div class="flex justify-center space-x-6 md:order-2">
            <a href="https://x.com/feyoudao_io" target="_blank" class="text-gray-400 hover:text-gray-500">
              <span class="sr-only">X</span>
              <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M13.6823 10.6218L20.2391 3H18.6854L12.9921 9.61788L8.44486 3H3.2002L10.0765 13.0074L3.2002 21H4.75404L10.7663 14.0113L15.5685 21H20.8131L13.6819 10.6218H13.6823ZM11.5541 13.0956L10.8574 12.0991L5.31391 4.16971H7.70053L12.1742 10.5689L12.8709 11.5655L18.6861 19.8835H16.2995L11.5541 13.096V13.0956Z" />
              </svg>
            </a>
            <a href="https://github.com/feyoudao-io/feyoudao" target="_blank" class="text-gray-400 hover:text-gray-500">
              <span class="sr-only">GitHub</span>
              <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path fill-rule="evenodd"
                  d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"
                  clip-rule="evenodd" />
              </svg>
            </a>
          </div> -->
          <div class="mt-8 md:order-1 md:mt-0">
            <p class="text-center text-xs leading-5 text-gray-500 dark:text-gray-400 flex justify-center items-center">
              &copy; <span id="currentYear"></span>&nbsp;Built with
              <a href="https://feyoudao.cn" class="text-green-600 hover:text-green-500 flex items-center ml-1"
                target="_blank">
                <svg width="10" height="12" viewBox="0 0 10 12" fill="none" xmlns="http://www.w3.org/2000/svg"
                  class="inline-block mr-1">
                  <g clip-path="url(#clip0_421_47774)">
                    <path d="M4.27777 9.11133H6.6111V12.0002L5.44444 10.8783L4.27777 12.0002V9.11133Z" fill="#FCB11E" />
                    <path
                      d="M9.05557 5.72222L5.22223 0L1.3889 5.72222H2.68634L0.444458 9.11111H10L7.75813 5.72222H9.05557Z"
                      fill="#2D9C6C" />
                  </g>
                  <defs>
                    <clipPath id="clip0_421_47774">
                      <rect width="9.55556" height="12" fill="white" transform="translate(0.444458)" />
                    </clipPath>
                  </defs>
                </svg>
                feyoudao
              </a>
            </p>
          </div>
        </div>
      </footer>
    </div>
  </div>

  <script>
      const jsonFiles = [
        "json/frontend.json",
        "json/common_use.json",
        "json/v2fds.json",
        "json/cheatSheet.json",
        "json/cheeseBookmark.json",
        "json/ahXuTag.json",
        "json/integrateResources.json",
      ];

      function loadAllJsonFiles() {
        return Promise.all(
          jsonFiles.map((file) =>
            fetch(file).then((response) => response.json())
          )
        ).then((results) => results.flat());
      }
      // 修改后的加载和渲染逻辑
      function loadAndRenderJsonFiles() {
        const container = document.getElementById("bookmarks");
        let allData = [];

        // 先立即加载并展示第一个文件
        fetch(jsonFiles[0])
          .then((response) => response.json())
          .then((firstData) => {
            allData = firstData;
            initialRender(firstData);
            // 加载完成后开始并行加载其他文件
            Promise.all(
              jsonFiles.slice(1).map((file) =>
                fetch(file)
                  .then((response) => response.json())
                  .catch((error) => {
                    console.error(`Error loading ${file}:`, error);
                    return []; // 返回空数组避免中断
                  })
              )
            ).then((otherResults) => {
              // 合并后续数据
              otherResults.forEach((data) => {
                allData = mergeData(allData, data);
              });
              // 增量更新界面
              incrementalUpdate(allData);
            });
          })
          .catch((error) => {
            console.error("Error loading initial file:", error);
            showErrorState();
          });

        // 初始渲染
        function initialRender(data) {
          renderNavigation(data, document.getElementById("navigation"), true);
          renderBookmarks(data, [{ title: "Bookmark", children: data }]);
          document.getElementById("loading-spinner").style.display = "none";
        }

        // 数据合并逻辑（可根据需要增强）
        function mergeData(existing, newData) {
          // 简单合并示例，可根据实际数据结构优化
          return [...existing, ...newData];
        }

        // 增量更新界面
        function incrementalUpdate(mergedData) {
          // 智能合并 DOM 更新（示例逻辑）
          const currentPath = getCurrentBreadcrumbPath();
          renderBookmarks(mergedData, currentPath);

          // 或者只更新差异部分
          // 这里需要根据实际数据结构实现更智能的对比更新
        }

        // 获取当前面包屑路径
        function getCurrentBreadcrumbPath() {
          const path = [];
          document
            .querySelectorAll("#breadcrumbs-path span")
            .forEach((element) => {
              path.push({
                title: element.innerText,
                children: [], // 这里需要根据实际数据结构补充
              });
            });
          return path;
        }
    }


    document.addEventListener('DOMContentLoaded', () => {
      // Variables for sidebar elements
      const openSidebarButton = document.getElementById('open-sidebar-button');
      const closeSidebarButton = document.getElementById('close-sidebar-button');
      const offCanvasMenu = document.getElementById('off-canvas-menu');
      const offCanvasBackdrop = document.getElementById('off-canvas-backdrop');
      const offCanvasContent = document.getElementById('off-canvas-content');

      // Function to open the sidebar
      const openSidebar = () => {
        offCanvasMenu.classList.remove('hidden');
        setTimeout(() => {
          offCanvasBackdrop.classList.add('opacity-100');
          offCanvasContent.classList.add('translate-x-0');
        }, 10);
      };

      // Function to close the sidebar
      const closeSidebar = () => {
        offCanvasBackdrop.classList.remove('opacity-100');
        offCanvasContent.classList.remove('translate-x-0');
        setTimeout(() => {
          offCanvasMenu.classList.add('hidden');
        }, 300); // Match the duration of the transition
      };

      // Event listeners for open and close buttons
      openSidebarButton?.addEventListener('click', openSidebar);
      closeSidebarButton.addEventListener('click', closeSidebar);
      offCanvasBackdrop.addEventListener('click', closeSidebar); // Close sidebar when clicking on the backdrop
    });

    // Search functionality
    function searchBookmarks(query) {
      loadAllJsonFiles()
        .then(data => {
          const results = searchInData(data, query.toLowerCase());
          renderBookmarks(results, [{ title: 'Search Results', children: results }]);
         })
        .catch(error => console.error('Error searching bookmarks:', error));
    }

    function searchInData(data, query) {
      let results = [];
      data.forEach(item => {
        if (item.title.toLowerCase().includes(query)) {
          results.push(item);
        }
        if (item.children) {
          const childResults = searchInData(item.children, query);
          if (childResults.length > 0) {
            results = results.concat(childResults);
          }
        }
      });
      return results;
    }

    document.getElementById('searchButton').addEventListener('click', () => {
      const query = document.getElementById('searchInput').value;
      searchBookmarks(query);
    });

    // Clear search results and reset UI
    function clearSearchResults() {
      const initialData = JSON.parse(sessionStorage.getItem('initialData')); // 从sessionStorage中获取初始数据
      if (initialData) {
        renderBookmarks(initialData, [{ title: 'Bookmark', children: initialData }]);
      }
      document.getElementById('searchInput').value = '';
      document.getElementById('clearSearchButton').classList.add('hidden');
    }

    document.getElementById('clearSearchButton').addEventListener('click', clearSearchResults);

    function searchBookmarks(query) {
      loadAllJsonFiles()
        .then(data => {
          const results = searchInData(data, query.toLowerCase());
          renderBookmarks(results, [{ title: 'Search Results', children: results }]);
        })
        .catch(error => console.error('Error searching bookmarks:', error));
    }

    // Create bookmark card element
    function createCard(title, url, icon, index) {
      const card = document.createElement('div');
      card.className = 'cursor-pointer flex items-center hover:shadow-sm transition-shadow p-4 bg-white shadow-sm ring-1 ring-gray-900/5 dark:feyoudao-ring-gray-800 rounded-lg hover:bg-gray-100 dark:feyoudao-bg-gray-700 dark:hover:feyoudao-bg-gray-600 card-shadow touch-feedback card-animate';
      card.style.animationDelay = `${index * 0.05}s`; // 错开动画时间
      card.onclick = () => window.open(url, '_blank');

      // 添加触摸反馈
      card.addEventListener('touchstart', function() {
        this.classList.add('active-touch');
      }, { passive: true });

      card.addEventListener('touchend', function() {
        this.classList.remove('active-touch');
      }, { passive: true });

      // 其余卡片内容保持不变
      const cardIcon = document.createElement('img');
      cardIcon.src = icon || 'assets/default-icon.svg';
      cardIcon.alt = title;
      cardIcon.className = 'w-8 h-8 mr-4 rounded-full flex-shrink-0 card-icon-bg';

      // 检查图片加载失败时使用默认图标
      cardIcon.onerror = () => {
        cardIcon.src = 'assets/default-icon.svg';
      };

      const cardContent = document.createElement('div');
      cardContent.className = 'flex flex-col overflow-hidden flex-grow';

      const cardTitle = document.createElement('h2');
      cardTitle.className = 'text-sm font-medium mb-1 truncate dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-gray-300';
      cardTitle.innerText = title;
      cardTitle.title = title;

      // 清理URL，删除http(s)和尾部斜杠
      const cleanUrl = url.replace(/^https?:\/\//, '').replace(/\/$/, '');

      const cardUrl = document.createElement('p');
      cardUrl.className = 'text-xs text-gray-400 dark:text-gray-600 dark:hover:text-gray-400 truncate';
      cardUrl.innerText = cleanUrl;

      cardContent.appendChild(cardTitle);
      cardContent.appendChild(cardUrl);

      card.appendChild(cardIcon);
      card.appendChild(cardContent);

      return card;
    }

    // Create folder card element
    function createFolderCard(title, children, path, index, color) {
      const card = document.createElement('div');
      card.className = 'folder-card text-gray rounded-lg cursor-pointer flex flex-col items-center p-3 transition-all duration-200 hover:shadow-md hover:translate-y-[-2px] relative card-animate touch-feedback';
      card.style.animationDelay = `${index * 0.05}s`; // 错开动画时间
      card.onclick = () => {
        const newPath = path.concat({ title, children });
        renderBookmarks(children, newPath);
        updateSidebarActiveState(newPath);
      };

      // 添加触摸反馈
      card.addEventListener('touchstart', function() {
        this.classList.add('active-touch');
      }, { passive: true });

      card.addEventListener('touchend', function() {
        this.classList.remove('active-touch');
      }, { passive: true });

      // 添加颜色标签
      if (color) {
        const colorTag = document.createElement('div');
        colorTag.className = 'folder-tag';
        colorTag.style.backgroundColor = color;
        card.appendChild(colorTag);
      }

      const cardIcon = document.createElement('div');
      cardIcon.innerHTML = `
        <svg viewBox="0 0 100 80" class="folder__svg w-16 h-16">
          <rect x="0" y="0" width="100" height="80" class="folder__back" />
          <rect x="15" y="8" width="70" height="60" class="paper-1" />
          <rect x="10" y="18" width="80" height="50" class="paper-2" />
          <rect x="0" y="10" width="100" height="70" class="folder__front" />
          <rect x="0" y="10" width="100" height="70" class="folder__front right" />
        </svg>
      `;
      cardIcon.className = 'mb-2';

      const cardTitle = document.createElement('h2');
      cardTitle.className = 'text-xs font-medium text-center w-full truncate dark:text-gray-400 transition-colors duration-200 group-hover:text-gray-900 dark:group-hover:text-white';
      cardTitle.innerText = title;

      card.appendChild(cardIcon);
      card.appendChild(cardTitle);

      return card;
    }

    // Render sidebar navigation
    function renderNavigation(folders, container, isFirstRender = false, parentPath = []) {
      container.innerHTML = '';
      // 过滤掉header类型
      folders = folders.filter(item => item.type !== 'header');

      folders.forEach((folder, index) => {
        if (folder.type === 'folder') {
          const navItem = document.createElement('li');
          navItem.className = 'items-center group flex justify-between gap-x-3 rounded-md p-2 text-gray-700 dark:text-gray-400 hover:text-main-500 hover:bg-gray-50 dark:hover:feyoudao-bg-gray-800 transition-colors duration-200';

          const navLinkContainer = document.createElement('div');
          navLinkContainer.className = 'flex items-center space-x-2 truncate';

          const folderIcon = document.createElement('span');
          folderIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7a2 2 0 012-2h4l2 2h7a2 2 0 012 2v7a2 2 0 01-2 2H5a2 2 0 01-2-2V7z" /></svg>';

          const navLink = document.createElement('a');
          navLink.className = 'flex text-sm leading-6 font-medium dark:text-gray-400';
          navLink.innerText = folder.title;

          navLinkContainer.appendChild(folderIcon);
          navLinkContainer.appendChild(navLink);

          const toggleIcon = document.createElement('span');
          toggleIcon.className = 'ml-2 transform transition-transform';
          toggleIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>';

          navItem.appendChild(navLinkContainer);
          if (folder.children && folder.children.length > 0) {
            navItem.appendChild(toggleIcon);
          }
          container.appendChild(navItem);

          if (folder.children && folder.children.length > 0) {
            const subList = document.createElement('ul');
            subList.className = 'ml-4 space-y-2 hidden';
            // 传递当前路径到子文件夹
            const currentPath = [...parentPath, { title: folder.title, children: folder.children }];
            renderNavigation(folder.children, subList, false, currentPath);
            container.appendChild(subList);

            navItem.onclick = (e) => {
              e.stopPropagation();
              document.querySelectorAll('#navigation .sidebar-active').forEach(el => el.classList.remove('sidebar-active'));
              navItem.classList.add('sidebar-active');
              subList.classList.toggle('hidden');
              if (subList.children.length > 0) {
                toggleIcon.classList.toggle('rotate-90');
              }
              // 使用完整的路径渲染面包屑
              const fullPath = [{ title: 'Bookmark', children: folders }, ...currentPath];
              renderBookmarks(folder.children, fullPath);
            };
          } else {
            navItem.onclick = (e) => {
              e.stopPropagation();
              document.querySelectorAll('#navigation .sidebar-active').forEach(el => el.classList.remove('sidebar-active'));
              navItem.classList.add('sidebar-active');
              // 使用完整的路径渲染面包屑
              const fullPath = [{ title: 'Bookmark', children: folders }, ...parentPath, { title: folder.title, children: folder.children }];
              renderBookmarks(folder.children, fullPath);
            };
          }
        }
      });
    }

    // Render breadcrumbs for navigation
    function renderBreadcrumbs(path) {
      const breadcrumbsPath = document.getElementById('breadcrumbs-path');
      breadcrumbsPath.innerHTML = '';

      path.forEach((item, index) => {
        const breadcrumb = document.createElement('span');
        breadcrumb.className = 'cursor-pointer hover:underline hover:text-gray-900 dark:hover:text-gray-200 transition-colors duration-200 touch-feedback';
        breadcrumb.innerText = item.title;
        breadcrumb.onclick = () => {
          const newPath = path.slice(0, index + 1);
          renderBookmarks(item.children, newPath);
          updateSidebarActiveState(newPath);
          document.getElementById('clearSearchButton').classList.add('hidden');
        };

        breadcrumbsPath.appendChild(breadcrumb);

        if (index < path.length - 1) {
          const separator = document.createElement('span');
          separator.innerText = ' > ';
          separator.className = 'mx-1 text-gray-400';
          breadcrumbsPath.appendChild(separator);
        }
      });
    }

    // Update the active state of sidebar items
    function updateSidebarActiveState(path) {
      document.querySelectorAll('#navigation .sidebar-active').forEach(el => el.classList.remove('sidebar-active'));

      let currentNav = document.getElementById('navigation');

      path.forEach((item, index) => {
        const items = currentNav.querySelectorAll('li');
        items.forEach(navItem => {
          const navLink = navItem.querySelector('a');
          if (navLink && navLink.innerText === item.title) {
            if (index === path.length - 1) {
              navItem.classList.add('sidebar-active');
            }

            if (index < path.length - 1) {
              const subList = navItem.querySelector('ul');
              if (subList) {
                subList.classList.remove('hidden');
                currentNav = subList;
              }
            }
          }
        });
      });
    }

    // Show a message when no search results are found
    function showNoResultsMessage() {
      const container = document.getElementById('bookmarks');
      container.innerHTML = '';

      const messageContainer = document.createElement('div');
      messageContainer.className = 'flex flex-col items-center justify-center h-64 w-full';

      const icon = document.createElement('svg');
      icon.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
      icon.setAttribute('class', 'h-16 w-16 text-gray-500 mb-4');
      icon.setAttribute('fill', 'none');
      icon.setAttribute('viewBox', '0 0 24 24');
      icon.setAttribute('stroke', 'currentColor');
      icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m9-3a9 9 0 11-18 0 9 9 0 0118 0z" />';

      const title = document.createElement('h2');
      title.className = 'text-gray-500 text-xl font-semibold mb-2';
      title.innerText = '没有找到相关结果';

      const message = document.createElement('p');
      message.className = 'text-gray-500 text-center max-w-md';
      message.innerText = '尝试使用其他关键词搜索，或者浏览其他分类发现更多精彩内容！';

      messageContainer.appendChild(icon);
      messageContainer.appendChild(title);
      messageContainer.appendChild(message);

      container.appendChild(messageContainer);
    }

    // Render bookmarks
    function renderBookmarks(data, path) {
      const container = document.getElementById('bookmarks');
      container.innerHTML = ''; // Clear previous content

      // Render breadcrumbs
      renderBreadcrumbs(path);

      // Separate folders, links, and headers
      const folders = data.filter(item => item.type === 'folder');
      const links = data.filter(item => item.type === 'link');
      const headers = data.filter(item => item.type === 'header');

      // Check if there are both links and headers (需要分组的情况)
      const shouldGroup = (links.length > 0 || headers.find(o=> o.children)) && headers.length > 0;

      if (folders.length === 0 && links.length === 0 && headers.length === 0) {
        showNoResultsMessage();
        return;
      }

      // Create folder section (添加动画和颜色标签)
      if (folders.length > 0) {
        const folderSection = document.createElement('div');
        folderSection.className = 'grid grid-cols-3 sm:grid-cols-6 lg:grid-cols-8 2xl:grid-cols-12 gap-6';
        folders.forEach((folder, index) => {
          // 从文件夹名称生成一个伪随机颜色（或者使用folder.color如果存在）
          const folderColor = folder.color || generateColorFromString(folder.title);
          const card = createFolderCard(folder.title, folder.children || [], path, index, folderColor);
          folderSection.appendChild(card);
        });
        container.appendChild(folderSection);
      }

      // 如果需要分组
      if (shouldGroup) {
        // Group data by header
        const groupedData = [];
        let currentGroup = null;

        data.forEach(item => {
          if (item.type === 'header') {
            // Start a new group
            currentGroup = {
              header: item,
              links: [],
              isExpanded: localStorage.getItem(`header-${item.title}`) !== 'false', // 默认展开，如果 localStorage 中存储为 false 则收缩
              color: item.color || generateColorFromString(item.title) // 添加颜色
            };
            if(item.children && item.children.length > 0) {
              item.children.forEach(child => {
                if (child.type === 'link') {
                  currentGroup.links.push(child);
                }
              });
            }
            groupedData.push(currentGroup);
          } else if (item.type === 'link' && currentGroup) {
            // Add link to the current group
            currentGroup.links.push(item);
          }
        });

        // Render grouped data
        groupedData.forEach(group => {
          const headerSection = document.createElement('div');
          headerSection.className = 'mb-4'; // Add margin-bottom for spacing

          // Render header
          const headerElement = document.createElement('div');
          headerElement.className = 'header-title flex items-center space-x-2 py-4 border-b dark:border-gray-700 cursor-pointer transition-colors duration-200 hover:bg-gray-50 dark:hover:feyoudao-bg-gray-800 rounded px-3 touch-feedback';

          // 添加颜色标记
          if (group.color) {
            const colorMark = document.createElement('div');
            colorMark.className = 'w-3 h-3 rounded-full mr-2 flex-shrink-0';
            colorMark.style.backgroundColor = group.color;
            headerElement.appendChild(colorMark);
          }

          const title = document.createElement('h2');
          title.className = 'text-lg font-semibold text-gray-700 dark:text-gray-300';
          title.textContent = group.header.title;

          // Add toggle icon
          const toggleIcon = document.createElement('span');
          toggleIcon.className = 'toggle-icon transform transition-transform ml-2 text-gray-500';
          toggleIcon.innerHTML = group.isExpanded ? '👇' : '👉';

          headerElement.appendChild(title);
          headerElement.appendChild(toggleIcon);
          headerSection.appendChild(headerElement);

          // Render links
          const contentSection = document.createElement('div');
          contentSection.className = 'grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 2xl:grid-cols-6 gap-4 mt-4';

          if (group.links.length > 0) {
            group.links.forEach((link, index) => {
              const card = createCard(link.title, link.url, link.icon, index);
              contentSection.appendChild(card);
            });
          }

          headerSection.appendChild(contentSection);

          // Set initial visibility based on isExpanded
          contentSection.style.display = group.isExpanded ? 'grid' : 'none';

          // Toggle header expansion on click
          headerElement.addEventListener('click', () => {
            group.isExpanded = !group.isExpanded;
            if (group.isExpanded) {
              contentSection.style.display = 'grid';
              toggleIcon.innerHTML = '👇';
            } else {
              contentSection.style.display = 'none';
              toggleIcon.innerHTML = '👉';
            }
            // Save the state to localStorage
            localStorage.setItem(`header-${group.header.title}`, group.isExpanded);
          });

          container.appendChild(headerSection);
        });
      } else {
        // 创建header部分
        if (headers.length > 0) {
          const headerSection = document.createElement('div');
          headerSection.className = 'grid grid-cols-1 gap-4 w-full';
          headers.forEach(header => {
            const headerElement = document.createElement('div');
            headerElement.className = 'header-title flex items-center space-x-2 py-4 border-b dark:border-gray-700 touch-feedback';

            // 添加颜色标记
            const headerColor = header.color || generateColorFromString(header.title);
            const colorMark = document.createElement('div');
            colorMark.className = 'w-3 h-3 rounded-full mr-2 flex-shrink-0';
            colorMark.style.backgroundColor = headerColor;
            headerElement.appendChild(colorMark);

            const title = document.createElement('h2');
            title.className = 'text-lg font-semibold text-gray-700 dark:text-gray-300';
            title.textContent = header.title;
            headerElement.appendChild(title);
            headerSection.appendChild(headerElement);
          });
          container.appendChild(headerSection);
        }

        // Add separator line if there are links
        if (folders.length > 0 && links.length > 0) {
          const separator = document.createElement('hr');
          separator.className = 'my-1 border-t-1 border-gray-200 dark:feyoudao-border-gray-800';
          container.appendChild(separator);
        }

        // Create link section
        if (links.length > 0) {
          const linkSection = document.createElement('div');
          linkSection.className = 'grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 2xl:grid-cols-6 gap-6';
          links.forEach((link, index) => {
            const card = createCard(link.title, link.url, link.icon, index);
            linkSection.appendChild(card);
          });
          container.appendChild(linkSection);
        }
      }

      // Update sidebar active state
      updateSidebarActiveState(path);
    }

    // 添加从字符串生成颜色的函数
    function generateColorFromString(str) {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        hash = str.charCodeAt(i) + ((hash << 5) - hash);
      }

      // 使用预定义的柔和颜色数组
      const colors = [
        '#4299e1', // 蓝色
        '#48bb78', // 绿色
        '#ed8936', // 橙色
        '#9f7aea', // 紫色
        '#f56565', // 红色
        '#38b2ac', // 青色
        '#ecc94b', // 黄色
        '#667eea', // 靛蓝色
        '#fc8181', // 粉色
        '#4fd1c5'  // 蓝绿色
      ];

      // 使用哈希值选择颜色
      return colors[Math.abs(hash) % colors.length];
    }

    // Fetch and render data
    loadAllJsonFiles().then(data => {
      const firstLayer = data;
      // 传递空数组作为初始父路径
      renderNavigation(firstLayer, document.getElementById('navigation'), true, []);
      renderBookmarks(firstLayer, [{ title: 'Bookmark', children: firstLayer }]);

      // 自动选择第一个项目
      if (firstLayer.length > 0) {
        const firstItem = firstLayer[0];
        const initialPath = [
          { title: 'Bookmark', children: firstLayer },
          { title: firstItem.title, children: firstItem.children }
        ];
        updateSidebarActiveState(initialPath);
        renderBookmarks(firstItem.children, initialPath);
      }
    })
    .catch(error => console.error('Error loading bookmarks:', error));

    function debounce(func, wait) {
      let timeout;
      return function (...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
      };
    }

    // Search functionality on pressing Enter
    document.getElementById('searchInput').addEventListener('input', debounce(function (event) {
      const query = event.target.value.trim();
      if (query) {
        searchBookmarks(query);
        document.getElementById('clearSearchButton').classList.remove('hidden');
      } else {
        clearSearchResults();
      }
    }, 300)); // 300ms 防抖

    // Search functionality on button click
    document.getElementById('searchButton').addEventListener('click', function () {
      const query = document.getElementById('searchInput').value;
      searchBookmarks(query);
    });

    // Theme toggle functionality
    const themeToggleButton = document.getElementById('themeToggleButton');
    const sunIcon = document.getElementById('sunIcon');
    const moonIcon = document.getElementById('moonIcon');

    // Apply dark theme
    function applyDarkTheme() {
      document.documentElement.classList.add('dark');
      sunIcon.classList.add('hidden');
      moonIcon.classList.remove('hidden');
    }

    // Apply light theme
    function applyLightTheme() {
      document.documentElement.classList.remove('dark');
      sunIcon.classList.remove('hidden');
      moonIcon.classList.add('hidden');
    }

    // Toggle theme between dark and light
    function toggleTheme() {
      if (document.documentElement.classList.contains('dark')) {
        applyLightTheme();
      } else {
        applyDarkTheme();
      }
    }

    // 在页面加载时保存初始数据
    document.addEventListener('DOMContentLoaded', () => {
      loadAllJsonFiles()
        .then(data => {
          sessionStorage.setItem('initialData', JSON.stringify(data)); // 保存初始数据
          // 渲染导航和书签
          // Hide loading spinner
          document.getElementById('loading-spinner').style.display = 'none';
        })
        .catch(error => {
          console.error('Error loading bookmarks:', error);
          document.getElementById('loading-spinner').style.display = 'none';
        });
    })

    // Event listener for theme toggle button
    themeToggleButton.addEventListener('click', toggleTheme);

    // Automatically apply theme according to system theme settings
    function applyColorTheme(theme) {
      if (theme === 'dark') {
        applyDarkTheme();
      } else {
        applyLightTheme();
      }
    }

    // Detect initial color theme
    const prefersDarkTheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
    applyColorTheme(prefersDarkTheme ? 'dark' : 'light');

    // Listen for changes in the color theme
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (event) => {
      applyColorTheme(event.matches ? 'dark' : 'light');
    });

    // Open mobile menu
    document.getElementById('open-sidebar-button')?.addEventListener('click', function () {
      var navigation = document.getElementById('navigation').cloneNode(true);
      document.getElementById('sidebar-2').appendChild(navigation);
    });

  </script>

  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      const yearElement = document.getElementById('currentYear');
      const currentYear = new Date().getFullYear();
      yearElement.textContent = currentYear;
    });
  </script>

  <script>
    // 优化移动端触摸体验
    document.addEventListener('DOMContentLoaded', function() {
      // 添加触摸反馈样式
      const style = document.createElement('style');
      style.textContent = `
        .active-touch {
          opacity: 0.7;
          transform: scale(0.98);
        }

        /* 平滑滚动 */
        html {
          scroll-behavior: smooth;
        }

        /* 自定义滚动条 */
        ::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }

        ::-webkit-scrollbar-track {
          background: transparent;
        }

        ::-webkit-scrollbar-thumb {
          background: #d1d5db;
          border-radius: 4px;
        }

        .dark ::-webkit-scrollbar-thumb {
          background: #4b5563;
        }

        ::-webkit-scrollbar-thumb:hover {
          background: #9ca3af;
        }

        .dark ::-webkit-scrollbar-thumb:hover {
          background: #6b7280;
        }
      `;
      document.head.appendChild(style);

      // 为所有可点击元素添加触摸反馈
      function addTouchFeedback() {
        const clickableElements = document.querySelectorAll('.cursor-pointer, button, a');
        clickableElements.forEach(el => {
          if (!el.classList.contains('touch-feedback')) {
            el.classList.add('touch-feedback');

            el.addEventListener('touchstart', function() {
              this.classList.add('active-touch');
            }, { passive: true });

            el.addEventListener('touchend', function() {
              this.classList.remove('active-touch');
            }, { passive: true });

            el.addEventListener('touchcancel', function() {
              this.classList.remove('active-touch');
            }, { passive: true });
          }
        });
      }

      // 初始添加触摸反馈
      addTouchFeedback();

      // 在DOM变化时重新添加触摸反馈
      const observer = new MutationObserver(function(mutations) {
        addTouchFeedback();
      });

      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
    });
  </script>

</body>

</html>